<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-pop Playlist Generator üé∂‚ú®</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 1s ease-out;
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 700;
            background: linear-gradient(45deg, #ff6b9d, #c44569);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            text-shadow: 0 4px 20px rgba(255, 107, 157, 0.3);
        }

        .header p {
            font-size: 1.2rem;
            color: #fff;
            opacity: 0.9;
            font-weight: 300;
        }

        .controls {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            animation: fadeInUp 1s ease-out 0.2s both;
        }

        .control-group {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .control-section {
            flex: 1;
            min-width: 200px;
        }

        .control-section h3 {
            font-size: 1.1rem;
            color: #444;
            margin-bottom: 10px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 1rem;
            background: white;
            color: #333;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        select:focus {
            outline: none;
            border-color: #ff6b9d;
            box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.1);
        }

        .generate-btn {
            background: linear-gradient(45deg, #ff6b9d, #c44569);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(255, 107, 157, 0.3);
            margin: 20px auto 0;
            display: block;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(255, 107, 157, 0.4);
        }

        .generate-btn:active {
            transform: translateY(0);
        }

        .generate-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .playlist {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            animation: fadeInUp 1s ease-out 0.4s both;
        }

        .track-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .track-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .track-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(45deg, #ff6b9d, #c44569);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .track-card:hover::before {
            opacity: 1;
        }

        .album-cover {
            width: 100%;
            height: 200px;
            border-radius: 12px;
            object-fit: cover;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .track-card:hover .album-cover {
            transform: scale(1.05);
            filter: brightness(1.1);
        }

        .track-info {
            text-align: left;
        }

        .track-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
            line-height: 1.3;
        }

        .track-artist {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .play-btn {
            background: linear-gradient(45deg, #ff6b9d, #c44569);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .play-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.4);
        }

        .loading {
            text-align: center;
            color: white;
            font-size: 1.2rem;
            margin: 40px 0;
        }

        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid #ff6b9d;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        .auth-section {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .auth-btn {
            background: #1db954;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(29, 185, 84, 0.3);
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(29, 185, 84, 0.4);
            background: #1ed760;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .emoji {
            font-size: 1.2em;
            margin-right: 5px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .control-group {
                flex-direction: column;
            }
            
            .playlist {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>K-pop Playlist Generator üé∂‚ú®</h1>
            <p>Discover amazing K-pop tracks based on your mood and vibe</p>
        </div>

        <div id="authSection" class="auth-section">
            <h2>üéµ Connect to Spotify</h2>
            <p style="margin: 20px 0; color: #666;">Connect your Spotify account to generate personalized K-pop playlists with real previews!</p>
            <button class="auth-btn" onclick="authenticateSpotify()">
                üéß Connect Spotify
            </button>
        </div>

        <div id="mainApp" style="display: none;">
            <div class="controls">
                <div class="control-group">
                    <div class="control-section">
                        <h3><span class="emoji">üòä</span>Mood</h3>
                        <select id="moodSelect">
                            <option value="">Select a mood...</option>
                            <option value="happy energetic">üòÑ Happy</option>
                            <option value="chill relaxed">üòå Chill</option>
                            <option value="energetic powerful">‚ö° Energetic</option>
                            <option value="sad emotional">üò¢ Sad</option>
                            <option value="romantic love">üíï Romantic</option>
                        </select>
                    </div>
                    <div class="control-section">
                        <h3><span class="emoji">üé®</span>Concept</h3>
                        <select id="conceptSelect">
                            <option value="">Select a concept...</option>
                            <option value="cute kawaii">üå∏ Cute</option>
                            <option value="fierce powerful">üî• Fierce</option>
                            <option value="retro vintage">üï∫ Retro</option>
                            <option value="dreamy ethereal">‚òÅÔ∏è Dreamy</option>
                            <option value="dark mysterious">üñ§ Dark</option>
                        </select>
                    </div>
                    <div class="control-section">
                        <h3><span class="emoji">üåø</span>Season</h3>
                        <select id="seasonSelect">
                            <option value="">Select a season...</option>
                            <option value="summer tropical">‚òÄÔ∏è Summer</option>
                            <option value="winter cozy">‚ùÑÔ∏è Winter</option>
                            <option value="spring fresh">üå± Spring</option>
                            <option value="autumn fall">üçÇ Fall</option>
                        </select>
                    </div>
                </div>
                <button class="generate-btn" onclick="generatePlaylist()">
                    ‚ú® Generate Playlist ‚ú®
                </button>
            </div>

            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Creating your perfect K-pop playlist... üéµ</p>
            </div>

            <div id="playlist" class="playlist"></div>
        </div>
    </div>

    <script>
        let accessToken = '';
        let currentAudio = null;
        let playingTrackId = '';

        // Spotify configuration
        const CLIENT_ID = "9738f4282c9b4019b378f8d68b43cffa"; // Replace with your Spotify Client ID
        const REDIRECT_URI = "https://kmaanasar.github.io/K-Pop-Playlist-Generator/";
        const SCOPES = 'user-read-private user-read-email';

        // K-pop artist keywords for better search results
        const kpopKeywords = [
            'BTS', 'BLACKPINK', 'TWICE', 'ITZY', 'aespa', 'Red Velvet', 'MAMAMOO',
            'SEVENTEEN', 'Stray Kids', 'ENHYPEN', 'TXT', 'IVE', 'NewJeans', 
            'LE SSERAFIM', 'NMIXX', 'KARD', 'EVERGLOW', 'ATEEZ', 'NCT',
            'Girls Generation', 'BIGBANG', 'SHINee', 'EXO', 'f(x)', 'Wonder Girls',
            'IU', 'TAEYEON', 'CHUNGHA', 'SUNMI', 'HyunA', 'DEAN', 'Zico',
            '(G)I-DLE', 'LOONA', 'fromis_9', 'WJSN', 'Oh My Girl', 'GFRIEND'
        ];

        // Check if user is returning from Spotify auth
        window.addEventListener('load', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            
            if (code) {
                // Handle the authorization code (in a real app, exchange for access token)
                // For demo purposes, we'll simulate getting a token
                accessToken = 'demo_token';
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                
                // Clean up URL
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        });

        function authenticateSpotify() {
            // In a real implementation, you would redirect to Spotify auth
            // For demo purposes, we'll simulate authentication
            alert('üéµ This is a demo! In a real implementation, this would redirect to Spotify authentication.\n\nFor now, you can use the demo mode with sample data.');
            
            accessToken = 'demo_token';
            document.getElementById('authSection').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
        }

        async function generatePlaylist() {
            const mood = document.getElementById('moodSelect').value;
            const concept = document.getElementById('conceptSelect').value;
            const season = document.getElementById('seasonSelect').value;

            if (!mood && !concept && !season) {
                alert('Please select at least one option to generate a playlist! üéµ');
                return;
            }

            document.getElementById('loading').style.display = 'block';
            document.getElementById('playlist').innerHTML = '';

            // Simulate API delay
            await new Promise(resolve => setTimeout(resolve, 2000));

            // In demo mode, generate sample playlist
            const sampleTracks = generateSamplePlaylist(mood, concept, season);
            displayPlaylist(sampleTracks);

            document.getElementById('loading').style.display = 'none';
        }

        function generateSamplePlaylist() {
            // Sample K-pop tracks for demo
            const sampleTracks = [
                {
                    id: '1',
                    name: 'Dynamite',
                    artists: [{ name: 'BTS' }],
                    album: {
                        images: [{ url: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=300&h=300&fit=crop' }]
                    },
                    preview_url: null
                },
                {
                    id: '2',
                    name: 'How You Like That',
                    artists: [{ name: 'BLACKPINK' }],
                    album: {
                        images: [{ url: 'https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=300&h=300&fit=crop' }]
                    },
                    preview_url: null
                },
                {
                    id: '3',
                    name: 'FANCY',
                    artists: [{ name: 'TWICE' }],
                    album: {
                        images: [{ url: 'https://images.unsplash.com/photo-1516280440614-37939bbacd81?w=300&h=300&fit=crop' }]
                    },
                    preview_url: null
                },
                {
                    id: '4',
                    name: 'Next Level',
                    artists: [{ name: 'aespa' }],
                    album: {
                        images: [{ url: 'https://images.unsplash.com/photo-1520170350707-b2da59970118?w=300&h=300&fit=crop' }]
                    },
                    preview_url: null
                },
                {
                    id: '5',
                    name: 'WANNABE',
                    artists: [{ name: 'ITZY' }],
                    album: {
                        images: [{ url: 'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?w=300&h=300&fit=crop' }]
                    },
                    preview_url: null
                },
                {
                    id: '6',
                    name: 'Love Dive',
                    artists: [{ name: 'IVE' }],
                    album: {
                        images: [{ url: 'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=300&h=300&fit=crop' }]
                    },
                    preview_url: null
                }
            ];

            // Shuffle and return random selection
            const shuffled = sampleTracks.sort(() => 0.5 - Math.random());
            return shuffled.slice(0, Math.floor(Math.random() * 3) + 3); // 3-5 tracks
        }

        function displayPlaylist(tracks) {
            const container = document.getElementById('playlist'); 
            container.innerHTML = '';
            
            tracks.forEach(t => {
                const card = document.createElement('div'); 
                card.className = 'track-card';
                card.innerHTML = `
                    <img src="${t.album.images[0]?.url}" class="album-cover">
                    <div class="track-info">
                        <div class="track-title">${t.name}</div>
                        <div class="track-artist">${t.artists.map(a => a.name).join(', ')}</div>
                        <button class="play-btn" onclick="togglePlay('${t.id}','${t.preview_url}')">
                            <span id="play-icon-${t.id}">‚ñ∂Ô∏è</span>
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function togglePlay(id, url) {
            if (playingTrackId === id) { 
                currentAudio?.pause(); 
                document.getElementById(`play-icon-${id}`).textContent = '‚ñ∂Ô∏è'; 
                playingTrackId = ''; 
                return; 
            }
            
            if (currentAudio) { 
                currentAudio.pause(); 
                document.getElementById(`play-icon-${playingTrackId}`).textContent = '‚ñ∂Ô∏è'; 
            }
            
            if (url) { 
                currentAudio = new Audio(url); 
                currentAudio.play(); 
                currentAudio.onended = () => {
                    document.getElementById(`play-icon-${id}`).textContent = '‚ñ∂Ô∏è'; 
                    playingTrackId = '';
                }; 
                document.getElementById(`play-icon-${id}`).textContent = '‚è∏Ô∏è'; 
                playingTrackId = id; 
            } else { 
                document.getElementById(`play-icon-${id}`).textContent = '‚è∏Ô∏è'; 
                playingTrackId = id; 
                setTimeout(() => {
                    document.getElementById(`play-icon-${id}`).textContent = '‚ñ∂Ô∏è'; 
                    playingTrackId = '';
                }, 3000);
            }
        } () => {
                        document.getElementById(`play-icon-${trackId}`).textContent = '‚ñ∂Ô∏è';
                        playingTrackId = '';
                    };
                    document.getElementById(`play-icon-${trackId}`).textContent = '‚è∏Ô∏è';
                    playingTrackId = trackId;
                } else {
                    // Demo mode - simulate playing
                    document.getElementById(`play-icon-${trackId}`).textContent = '‚è∏Ô∏è';
                    playingTrackId = trackId;
                    
                    setTimeout(() => {
                        document.getElementById(`play-icon-${trackId}`).textContent = '‚ñ∂Ô∏è';
                        playingTrackId = '';
                    }, 3000); // Simulate 3 second preview
                }
            }
        }

        // Real Spotify API functions (for when you have API access)
        async function searchKpopTracks(query, limit = 10) {
            try {
                const response = await fetch(`https://api.spotify.com/v1/search?q=${encodeURIComponent(query)}&type=track&market=US&limit=${limit}`, {
                    headers: {
                        'Authorization': `Bearer ${accessToken}`
                    }
                });

                if (!response.ok) {
                    throw new Error('Failed to search tracks');
                }

                const data = await response.json();
                return data.tracks.items;
            } catch (error) {
                console.error('Error searching tracks:', error);
                return [];
            }
        }

        function buildSearchQuery(mood, concept, season) {
            let queryParts = [];
            
            // Add selected criteria
            if (mood) queryParts.push(mood);
            if (concept) queryParts.push(concept);
            if (season) queryParts.push(season);
            
            // Add random K-pop artist
            const randomArtist = kpopKeywords[Math.floor(Math.random() * kpopKeywords.length)];
            queryParts.push(randomArtist);
            
            // Add K-pop genre indicators
            queryParts.push('kpop OR korean OR hallyu');
            
            return queryParts.join(' ');
        }
    </script>
</body>
</html>